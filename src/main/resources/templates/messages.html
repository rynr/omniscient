<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>omniscient</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="css/normalize.min.css" />
    <link rel="stylesheet" href="css/main.css" />
  </head>
  <body>
    <header th:fragment="header">
      <div class="wrapper">
        <h1>Log</h1>
        <nav>
          <ul>
            <li sec:authorize="isAuthenticated()" sec:authentication="name"></li>
            <li sec:authorize="isAuthenticated()"><a href="root.html" th:href="'javascript:document.getElementById(\'logoutForm\').submit()'">logout</a><form id="logoutForm" action="/index.html" th:action="@{/logout}" method="post"></form></li>
            <li sec:authorize="!isAuthenticated()"><a href="messages.html" th:href="@{/login}">login</a></li>
            <li><a href="messages.html" target="_self">â†»</a></li>
          </ul>
        </nav>
      </div>
    </header>
    <div class="wrapper">
      <div>
        <form action="#" th:action="@{/messages.html}" method="post">
          <input name="message" autofocus="autofocus"/>
        </form>
      </div>
      <table><th:block th:each="message,iterStat : ${messages}">
        <tr th:if="${iterStat.index} == 0 or ( ${messages.get(iterStat.index - 1).createdAt.toLocalDate()} != ${message.createdAt.toLocalDate()})">
          <th colspan="3" th:text="${message.createdAt.toLocalDate()}"></th>
        </tr>
        <tr>
          <td th:text="${message.type.identifier}">(i)</td>
          <td>
            <span th:text="${message.content}"></span>
            <small th:text="${message.createdAt.toLocalTime()}"></small>
          </td>
        </tr></th:block>
      </table>
    </div>
  </body>
</html>